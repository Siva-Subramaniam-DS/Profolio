[phases.setup]
nixPkgs = ["nodejs-18_x"]

[phases.install]
# Clean install to fix Rollup native module issues
# As per error message: remove package-lock.json and node_modules for fresh install
# This ensures platform-specific optional dependencies (Rollup native bindings) are installed
cmds = [
  "rm -rf node_modules package-lock.json || true",
  "npm install",
  "npm rebuild || true"
]

[phases.build]
cmds = ["npm run build"]

